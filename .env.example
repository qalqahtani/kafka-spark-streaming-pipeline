# =============================================================================
# Kafka-Spark Video Streaming Pipeline — Environment Variables
# =============================================================================
# All tuneable values live here. docker-compose.yml and application code
# read these at startup. Edit here; never hard-code in source files.
# =============================================================================

# -----------------------------------------------------------------------------
# KAFKA (KRaft mode — no ZooKeeper)
# -----------------------------------------------------------------------------
KAFKA_EXTERNAL_PORT=9094          # port exposed on the host for external tools
VOD_TOPIC=vod-chunks              # Kafka topic for VOD chunk metadata
LIVE_TOPIC=live-chunks            # Kafka topic for live chunk metadata
KAFKA_MESSAGE_MAX_BYTES=1048576   # 1 MB — Kafka carries metadata ONLY, never video bytes

# -----------------------------------------------------------------------------
# MONGODB
# -----------------------------------------------------------------------------
MONGO_PORT=27017
MONGO_DB=pipeline                 # database name used by API and Spark

# -----------------------------------------------------------------------------
# MINIO (S3-compatible object store)
# -----------------------------------------------------------------------------
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin123
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001
# Bucket names (created automatically by the minio-init container at startup)
MINIO_BUCKET_VOD_RAW=vod-raw
MINIO_BUCKET_VOD_VARIANTS=vod-variants
MINIO_BUCKET_LIVE=live-streams
MINIO_BUCKET_MANIFESTS=manifests

# -----------------------------------------------------------------------------
# FASTAPI
# -----------------------------------------------------------------------------
API_PORT=8000

# -----------------------------------------------------------------------------
# MONITORING
# -----------------------------------------------------------------------------
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin

# -----------------------------------------------------------------------------
# PRODUCER simulation settings
# -----------------------------------------------------------------------------
# How often the VOD producer calls FastAPI (seconds between uploads)
VOD_INTERVAL_MIN=10
VOD_INTERVAL_MAX=20
# How often the live RTMP ingest pushes a chunk directly to Kafka
LIVE_INTERVAL_MIN=0.5
LIVE_INTERVAL_MAX=1.0
# Simulated file sizes
VOD_MIN_SIZE_BYTES=5000000        # 5 MB  — realistic HLS segment for VOD
VOD_MAX_SIZE_BYTES=20000000       # 20 MB
LIVE_MIN_SIZE_BYTES=500000        # 500 KB — small live segment
LIVE_MAX_SIZE_BYTES=2000000       # 2 MB

# -----------------------------------------------------------------------------
# SPARK
# -----------------------------------------------------------------------------
SPARK_MASTER_PORT=7077
SPARK_MASTER_UI_PORT=8090         # avoid conflict with Redpanda Console on 8080
SPARK_WORKER_MEMORY=2g
SPARK_WORKER_CORES=2
SPARK_JOB_METRICS_PORT=8765      # prometheus_client HTTP server in the Spark driver

# -----------------------------------------------------------------------------
# MATCH / VOD simulation metadata
# -----------------------------------------------------------------------------
DVR_WINDOW_SIZE=10               # number of chunks kept in the rolling live manifest
MATCH_HOME_TEAM=Al-Hilal
MATCH_AWAY_TEAM=Al-Nassr
MATCH_COMPETITION=Saudi Pro League
VOD_SHOW_NAME=My Streaming Show
