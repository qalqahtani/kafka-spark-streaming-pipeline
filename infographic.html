<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kafka-Spark Streaming Pipeline ‚Äî Health Report</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: #0d1117;
      color: #cdd9e5;
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      font-size: 14px;
      line-height: 1.5;
      padding: 40px;
      max-width: 1280px;
      margin: 0 auto;
    }

    /* ‚îÄ‚îÄ Typography ‚îÄ‚îÄ */
    h1 { font-size: 28px; font-weight: 700; letter-spacing: -0.5px; }
    h2 { font-size: 12px; font-weight: 600; letter-spacing: 2px; text-transform: uppercase; color: #768390; margin-bottom: 16px; }
    h3 { font-size: 15px; font-weight: 600; color: #cdd9e5; }

    /* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      padding-bottom: 28px;
      border-bottom: 1px solid #21262d;
      margin-bottom: 36px;
    }
    .header-left .badge {
      display: inline-block;
      background: #1f6feb22;
      border: 1px solid #1f6feb66;
      color: #58a6ff;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 1px;
      text-transform: uppercase;
      padding: 3px 10px;
      border-radius: 20px;
      margin-bottom: 10px;
    }
    .header-left h1 { color: #e6edf3; }
    .header-left .subtitle { color: #768390; font-size: 13px; margin-top: 4px; }
    .header-right { text-align: right; font-size: 12px; color: #768390; }
    .header-right .timestamp { font-size: 13px; color: #cdd9e5; font-weight: 500; }
    .status-dot { display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: #3fb950; margin-right: 6px; box-shadow: 0 0 6px #3fb950; }

    /* ‚îÄ‚îÄ Section wrapper ‚îÄ‚îÄ */
    .section { margin-bottom: 40px; }

    /* ‚îÄ‚îÄ Health Grid ‚îÄ‚îÄ */
    .health-grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 12px;
    }
    .stat-card {
      background: #161b22;
      border: 1px solid #21262d;
      border-radius: 10px;
      padding: 18px 16px;
      position: relative;
      overflow: hidden;
    }
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 3px;
      border-radius: 10px 10px 0 0;
    }
    .stat-card.green::before  { background: #3fb950; }
    .stat-card.orange::before { background: #d29922; }
    .stat-card.red::before    { background: #f85149; }
    .stat-card.blue::before   { background: #58a6ff; }

    .stat-card .label {
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.8px;
      text-transform: uppercase;
      color: #768390;
      margin-bottom: 8px;
    }
    .stat-card .value {
      font-size: 32px;
      font-weight: 700;
      letter-spacing: -1px;
      line-height: 1;
      margin-bottom: 6px;
    }
    .stat-card.green  .value { color: #3fb950; }
    .stat-card.orange .value { color: #d29922; }
    .stat-card.red    .value { color: #f85149; }
    .stat-card.blue   .value { color: #58a6ff; }

    .stat-card .unit { font-size: 13px; font-weight: 400; opacity: 0.7; margin-left: 2px; }
    .stat-card .meaning {
      font-size: 11px;
      color: #768390;
      margin-top: 8px;
      line-height: 1.4;
    }
    .stat-card .verdict {
      display: inline-block;
      margin-top: 8px;
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      padding: 2px 8px;
      border-radius: 4px;
    }
    .stat-card.green  .verdict { background: #3fb95022; color: #3fb950; }
    .stat-card.orange .verdict { background: #d2992222; color: #d29922; }
    .stat-card.red    .verdict { background: #f8514922; color: #f85149; }
    .stat-card.blue   .verdict { background: #58a6ff22; color: #58a6ff; }

    /* ‚îÄ‚îÄ Pipeline Flow ‚îÄ‚îÄ */
    .flow-container {
      background: #161b22;
      border: 1px solid #21262d;
      border-radius: 10px;
      padding: 28px 32px;
    }
    .flow-row {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      gap: 0;
    }
    .flow-row:last-child { margin-bottom: 0; }

    .flow-label {
      width: 70px;
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: #768390;
      flex-shrink: 0;
    }
    .flow-node {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      padding: 10px 14px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      white-space: nowrap;
      min-width: 100px;
    }
    .flow-node .node-name { font-size: 12px; font-weight: 700; }
    .flow-node .node-sub  { font-size: 10px; font-weight: 400; opacity: 0.75; margin-top: 2px; }

    .node-producer  { background: #1c2128; border: 1.5px solid #58a6ff55; color: #58a6ff; }
    .node-kafka     { background: #1c2128; border: 1.5px solid #8957e555; color: #bc8cff; }
    .node-spark     { background: #1c2128; border: 1.5px solid #e3b34155; color: #e3b341; }
    .node-minio     { background: #1c2128; border: 1.5px solid #3fb95055; color: #3fb950; }
    .node-mongo     { background: #1c2128; border: 1.5px solid #f7853255; color: #f78532; }
    .node-api       { background: #1c2128; border: 1.5px solid #58a6ff33; color: #79c0ff; }
    .node-viewer    { background: #1c2128; border: 1.5px solid #8957e533; color: #d2a8ff; }

    .arrow {
      flex: 1;
      display: flex;
      align-items: center;
      position: relative;
      height: 2px;
      min-width: 20px;
    }
    .arrow-line {
      height: 1.5px;
      width: 100%;
      background: linear-gradient(90deg, #30363d, #58a6ff66, #30363d);
    }
    .arrow-head {
      position: absolute;
      right: -1px;
      width: 0;
      height: 0;
      border-top: 5px solid transparent;
      border-bottom: 5px solid transparent;
      border-left: 7px solid #58a6ff66;
    }
    .arrow-label {
      position: absolute;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 9px;
      color: #768390;
      white-space: nowrap;
      font-weight: 500;
    }

    .flow-connector { display: flex; align-items: center; flex: 1; }

    /* ‚îÄ‚îÄ Two-column stream cards ‚îÄ‚îÄ */
    .stream-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    .stream-card {
      background: #161b22;
      border: 1px solid #21262d;
      border-radius: 10px;
      padding: 22px;
    }
    .stream-card .stream-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid #21262d;
    }
    .stream-icon {
      width: 36px; height: 36px;
      border-radius: 8px;
      display: flex; align-items: center; justify-content: center;
      font-size: 18px;
    }
    .live-icon  { background: #f8514922; }
    .vod-icon   { background: #1f6feb22; }
    .stream-card .stream-title { font-size: 16px; font-weight: 700; }
    .stream-card .stream-desc  { font-size: 11px; color: #768390; }

    .metric-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      padding: 9px 0;
      border-bottom: 1px solid #21262d22;
    }
    .metric-row:last-child { border-bottom: none; }
    .metric-name  { font-size: 12px; color: #768390; }
    .metric-value { font-size: 14px; font-weight: 700; }
    .metric-value.good    { color: #3fb950; }
    .metric-value.warn    { color: #d29922; }
    .metric-value.bad     { color: #f85149; }
    .metric-value.neutral { color: #58a6ff; }

    .progress-bar-wrap {
      margin-top: 4px;
      height: 3px;
      background: #21262d;
      border-radius: 2px;
      overflow: hidden;
    }
    .progress-bar { height: 100%; border-radius: 2px; }

    /* ‚îÄ‚îÄ Failures explanation ‚îÄ‚îÄ */
    .failures-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    .failure-card {
      background: #161b22;
      border: 1px solid #21262d;
      border-radius: 10px;
      padding: 20px;
    }
    .failure-card .failure-icon {
      font-size: 28px;
      margin-bottom: 12px;
    }
    .failure-card h3 { margin-bottom: 6px; }
    .failure-card .numbers {
      display: flex;
      gap: 16px;
      margin: 12px 0;
    }
    .failure-card .num-block .num {
      font-size: 24px;
      font-weight: 700;
    }
    .failure-card .num-block .num-label {
      font-size: 10px;
      color: #768390;
      text-transform: uppercase;
    }
    .failure-card p { font-size: 12px; color: #768390; line-height: 1.6; }
    .tag {
      display: inline-block;
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 0.5px;
      padding: 2px 8px;
      border-radius: 4px;
      margin-bottom: 10px;
    }
    .tag-simulated { background: #d2992222; color: #d29922; }
    .tag-ok        { background: #3fb95022; color: #3fb950; }
    .tag-expected  { background: #58a6ff22; color: #58a6ff; }

    /* ‚îÄ‚îÄ Services ‚îÄ‚îÄ */
    .services-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 10px;
    }
    .service-card {
      background: #161b22;
      border: 1px solid #21262d;
      border-radius: 8px;
      padding: 14px 10px;
      text-align: center;
    }
    .service-card .svc-icon { font-size: 22px; margin-bottom: 6px; }
    .service-card .svc-name { font-size: 11px; font-weight: 600; color: #cdd9e5; }
    .service-card .svc-status {
      margin-top: 6px;
      font-size: 10px;
      font-weight: 700;
      color: #3fb950;
      letter-spacing: 0.5px;
    }
    .service-card .svc-detail { font-size: 10px; color: #768390; margin-top: 2px; }

    /* ‚îÄ‚îÄ Throughput bar chart ‚îÄ‚îÄ */
    .bar-chart {
      background: #161b22;
      border: 1px solid #21262d;
      border-radius: 10px;
      padding: 22px;
    }
    .bar-group { margin-bottom: 14px; }
    .bar-group:last-child { margin-bottom: 0; }
    .bar-top { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 6px; }
    .bar-name  { font-size: 12px; color: #cdd9e5; font-weight: 500; }
    .bar-val   { font-size: 12px; font-weight: 700; }
    .bar-outer { background: #21262d; border-radius: 3px; height: 8px; overflow: hidden; }
    .bar-inner { height: 100%; border-radius: 3px; }

    /* ‚îÄ‚îÄ Footer ‚îÄ‚îÄ */
    .footer {
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #21262d;
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      color: #768390;
    }

    /* ‚îÄ‚îÄ Print ‚îÄ‚îÄ */
    @media print {
      body { background: white; color: black; padding: 20px; }
    }
  </style>
</head>
<body>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- HEADER -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="header">
    <div class="header-left">
      <div class="badge">Live Health Report</div>
      <h1>Kafka-Spark Video Streaming Pipeline</h1>
      <div class="subtitle">Distributed ingest ¬∑ Stream processing ¬∑ Object storage ¬∑ Observability</div>
    </div>
    <div class="header-right">
      <div><span class="status-dot"></span> All services running</div>
      <div class="timestamp">February 26, 2026 ‚Äî 22:15</div>
      <div style="margin-top:4px">Stack: Kafka 4.x ¬∑ Spark 4.1.1 ¬∑ MongoDB 7 ¬∑ MinIO</div>
    </div>
  </div>


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- SECTION 1: HEALTH AT A GLANCE -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section">
    <h2>System Health at a Glance</h2>
    <div class="health-grid">

      <div class="stat-card green">
        <div class="label">Kafka Consumer Lag</div>
        <div class="value">0<span class="unit">msg</span></div>
        <div class="meaning">Messages waiting in Kafka that Spark hasn't read yet. Zero means Spark consumes every event instantly.</div>
        <div class="verdict">Perfect</div>
      </div>

      <div class="stat-card red">
        <div class="label">Live Latency p99</div>
        <div class="value">~2<span class="unit">s</span></div>
        <div class="meaning">99th-percentile time for Spark to process one live chunk. Red on a Mac (14 containers sharing CPU). Would be &lt;500ms on a server.</div>
        <div class="verdict">Mac CPU</div>
      </div>

      <div class="stat-card green">
        <div class="label">VOD Latency p95</div>
        <div class="value">~8<span class="unit">s</span></div>
        <div class="meaning">95th-percentile upload-to-ready time per episode. Includes ~5s Kafka queue + 2‚Äì4s transcode simulation. Well under 15s threshold.</div>
        <div class="verdict">Healthy</div>
      </div>

      <div class="stat-card orange">
        <div class="label">Checksum Failures/s</div>
        <div class="value">0.045</div>
        <div class="meaning">~0.045 failures/second across 2 live streams. 2% failure rate is intentionally simulated to demonstrate detection metrics.</div>
        <div class="verdict">Simulated</div>
      </div>

      <div class="stat-card blue">
        <div class="label">Active Live Streams</div>
        <div class="value">2</div>
        <div class="meaning">Two live streams running simultaneously. The producer runs 1,000-chunk streams; occasionally a new one starts before the previous fully closes.</div>
        <div class="verdict">Normal</div>
      </div>

      <div class="stat-card green">
        <div class="label">Services Up</div>
        <div class="value">7<span class="unit">/7</span></div>
        <div class="meaning">All Prometheus scrape targets responding: Kafka, Producer, FastAPI, Spark, MongoDB, MinIO, Prometheus itself.</div>
        <div class="verdict">All Up</div>
      </div>

    </div>
  </div>


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- SECTION 2: PIPELINE DATA FLOW -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section">
    <h2>Pipeline Data Flow</h2>
    <div class="flow-container">

      <!-- VOD PATH -->
      <div class="flow-row">
        <div class="flow-label">VOD Path</div>
        <div class="flow-node node-producer">
          <div class="node-name">Producer</div>
          <div class="node-sub">every 10‚Äì20s</div>
        </div>
        <div class="arrow" style="flex:0.4">
          <div class="arrow-line"></div>
          <div class="arrow-head"></div>
          <div class="arrow-label">POST /vod/upload</div>
        </div>
        <div class="flow-node node-api">
          <div class="node-name">FastAPI</div>
          <div class="node-sub">control plane</div>
        </div>
        <div class="arrow" style="flex:0.4">
          <div class="arrow-line"></div>
          <div class="arrow-head"></div>
          <div class="arrow-label">publish event</div>
        </div>
        <div class="flow-node node-kafka">
          <div class="node-name">Kafka</div>
          <div class="node-sub">vod-chunks</div>
        </div>
        <div class="arrow" style="flex:0.4">
          <div class="arrow-line"></div>
          <div class="arrow-head"></div>
          <div class="arrow-label">5s trigger</div>
        </div>
        <div class="flow-node node-spark">
          <div class="node-name">Spark</div>
          <div class="node-sub">transcode + variants</div>
        </div>
        <div class="arrow" style="flex:0.4">
          <div class="arrow-line"></div>
          <div class="arrow-head"></div>
          <div class="arrow-label">write segments</div>
        </div>
        <div class="flow-node node-minio">
          <div class="node-name">MinIO</div>
          <div class="node-sub">vod-variants</div>
        </div>
        <div class="arrow" style="flex:0.4">
          <div class="arrow-line"></div>
          <div class="arrow-head"></div>
          <div class="arrow-label">upsert doc</div>
        </div>
        <div class="flow-node node-mongo">
          <div class="node-name">MongoDB</div>
          <div class="node-sub">vod_metadata</div>
        </div>
      </div>

      <!-- LIVE PATH -->
      <div class="flow-row" style="margin-top:18px">
        <div class="flow-label">Live Path</div>
        <div class="flow-node node-producer">
          <div class="node-name">Producer</div>
          <div class="node-sub">every 0.5‚Äì1s</div>
        </div>
        <div class="arrow" style="flex:1.6; min-width:60px">
          <div class="arrow-line" style="background:linear-gradient(90deg,#30363d,#f8514966,#30363d)"></div>
          <div class="arrow-head" style="border-left-color:#f8514966"></div>
          <div class="arrow-label" style="color:#f85149">direct to Kafka ‚Äî no FastAPI</div>
        </div>
        <div class="flow-node node-kafka" style="margin-left:0">
          <div class="node-name">Kafka</div>
          <div class="node-sub">live-chunks</div>
        </div>
        <div class="arrow" style="flex:0.4">
          <div class="arrow-line"></div>
          <div class="arrow-head"></div>
          <div class="arrow-label">1s trigger</div>
        </div>
        <div class="flow-node node-spark">
          <div class="node-name">Spark</div>
          <div class="node-sub">DVR manifest</div>
        </div>
        <div class="arrow" style="flex:0.4">
          <div class="arrow-line"></div>
          <div class="arrow-head"></div>
          <div class="arrow-label">write chunk</div>
        </div>
        <div class="flow-node node-minio">
          <div class="node-name">MinIO</div>
          <div class="node-sub">live-streams</div>
        </div>
        <div class="arrow" style="flex:0.4">
          <div class="arrow-line"></div>
          <div class="arrow-head"></div>
          <div class="arrow-label">upsert doc</div>
        </div>
        <div class="flow-node node-mongo">
          <div class="node-name">MongoDB</div>
          <div class="node-sub">live_metadata</div>
        </div>
      </div>

      <!-- READ PATH -->
      <div class="flow-row" style="margin-top:18px; opacity:0.75">
        <div class="flow-label" style="color:#8957e5">Read Path</div>
        <div class="flow-node node-viewer">
          <div class="node-name">Viewer / App</div>
          <div class="node-sub">VLC ¬∑ HLS.js</div>
        </div>
        <div class="arrow" style="flex:0.5">
          <div class="arrow-line" style="background:linear-gradient(90deg,#30363d,#8957e566,#30363d)"></div>
          <div class="arrow-head" style="border-left-color:#8957e566"></div>
          <div class="arrow-label">GET /vod/{id}/manifest</div>
        </div>
        <div class="flow-node node-api">
          <div class="node-name">FastAPI</div>
          <div class="node-sub">presigned URL</div>
        </div>
        <div class="arrow" style="flex:0.5">
          <div class="arrow-line" style="background:linear-gradient(90deg,#30363d,#8957e566,#30363d)"></div>
          <div class="arrow-head" style="border-left-color:#8957e566"></div>
          <div class="arrow-label">fetch .m3u8 + .ts</div>
        </div>
        <div class="flow-node node-minio">
          <div class="node-name">MinIO</div>
          <div class="node-sub">manifests bucket</div>
        </div>
        <div style="flex:1; padding-left:16px; font-size:11px; color:#768390; line-height:1.5;">
          In production: <strong style="color:#cdd9e5">CDN</strong> (CloudFront / Akamai) sits in front of S3.<br>
          URL = <code style="color:#8957e5">cdn.example.com/manifests/{stream_id}/live_manifest.m3u8</code>
        </div>
      </div>

    </div>
  </div>


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- SECTION 3: STREAM METRICS SIDE BY SIDE -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section">
    <h2>Stream Performance</h2>
    <div class="stream-grid">

      <!-- LIVE -->
      <div class="stream-card">
        <div class="stream-header">
          <div class="stream-icon live-icon">üì°</div>
          <div>
            <div class="stream-title">Live Stream</div>
            <div class="stream-desc">Continuous low-latency ingest ¬∑ 2 active streams</div>
          </div>
        </div>

        <div class="metric-row">
          <span class="metric-name">Chunks produced / sec</span>
          <span class="metric-value neutral">1.32 /s</span>
        </div>
        <div class="progress-bar-wrap"><div class="progress-bar" style="width:66%;background:#58a6ff"></div></div>

        <div class="metric-row">
          <span class="metric-name">Chunks processed by Spark / sec</span>
          <span class="metric-value good">1.32 /s</span>
        </div>
        <div class="progress-bar-wrap"><div class="progress-bar" style="width:66%;background:#3fb950"></div></div>

        <div class="metric-row">
          <span class="metric-name">Kafka consumer lag</span>
          <span class="metric-value good">0 messages</span>
        </div>

        <div class="metric-row">
          <span class="metric-name">Processing latency p99</span>
          <span class="metric-value bad">~2,000 ms</span>
        </div>

        <div class="metric-row">
          <span class="metric-name">Total chunks processed</span>
          <span class="metric-value neutral">1,149</span>
        </div>

        <div class="metric-row">
          <span class="metric-name">Sequence gaps detected</span>
          <span class="metric-value warn">217 total</span>
        </div>

        <div class="metric-row">
          <span class="metric-name">DVR window size</span>
          <span class="metric-value neutral">10 segments</span>
        </div>

        <div class="metric-row">
          <span class="metric-name">Checksum failures</span>
          <span class="metric-value warn">35 total (~3%)</span>
        </div>

        <div style="margin-top:16px; padding:12px; background:#f8514908; border:1px solid #f8514922; border-radius:6px; font-size:11px; color:#768390; line-height:1.6">
          <strong style="color:#f85149">Why the high latency?</strong><br>
          All 14 containers share your Mac's CPU. On a dedicated server with 8+ cores, p99 latency would be well under 500ms. The key indicator is Kafka lag = 0 ‚Äî Spark is keeping up, just slower than production speed.
        </div>
      </div>

      <!-- VOD -->
      <div class="stream-card">
        <div class="stream-header">
          <div class="stream-icon vod-icon">üé¨</div>
          <div>
            <div class="stream-title">VOD (On-Demand)</div>
            <div class="stream-desc">Upload ‚Üí transcode ‚Üí manifest ‚Üí ready ¬∑ 4 quality variants</div>
          </div>
        </div>

        <div class="metric-row">
          <span class="metric-name">Episodes uploaded / sec</span>
          <span class="metric-value neutral">0.055 /s</span>
        </div>
        <div class="progress-bar-wrap"><div class="progress-bar" style="width:5%;background:#58a6ff"></div></div>

        <div class="metric-row">
          <span class="metric-name">Episodes processed by Spark / sec</span>
          <span class="metric-value good">0.08 /s</span>
        </div>
        <div class="progress-bar-wrap"><div class="progress-bar" style="width:8%;background:#3fb950"></div></div>

        <div class="metric-row">
          <span class="metric-name">Variants generated / sec</span>
          <span class="metric-value good">0.32 /s  (= 4√ó chunks)</span>
        </div>
        <div class="progress-bar-wrap"><div class="progress-bar" style="width:32%;background:#3fb950"></div></div>

        <div class="metric-row">
          <span class="metric-name">Processing latency p95</span>
          <span class="metric-value good">~8,000 ms</span>
        </div>

        <div class="metric-row">
          <span class="metric-name">Episodes ready in MongoDB</span>
          <span class="metric-value good">58 / 58</span>
        </div>

        <div class="metric-row">
          <span class="metric-name">VOD objects in MinIO</span>
          <span class="metric-value neutral">46 objects</span>
        </div>

        <div class="metric-row">
          <span class="metric-name">Quality variants per episode</span>
          <span class="metric-value neutral">1080p ¬∑ 720p ¬∑ 480p ¬∑ 360p</span>
        </div>

        <div class="metric-row">
          <span class="metric-name">Checksum failures</span>
          <span class="metric-value warn">2 total (~3%)</span>
        </div>

        <div style="margin-top:16px; padding:12px; background:#3fb95008; border:1px solid #3fb95022; border-radius:6px; font-size:11px; color:#768390; line-height:1.6">
          <strong style="color:#3fb950">Healthy pipeline.</strong><br>
          100% of uploaded episodes reach <code>status: ready</code>. Variants/s is exactly 4√ó chunks/s ‚Äî the transcode step runs without errors. Latency at 8s is within the green threshold of 15s.
        </div>
      </div>

    </div>
  </div>


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- SECTION 4: UNDERSTANDING THE "FAILURES" -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section">
    <h2>Understanding the Failures ‚Äî None Are Real Bugs</h2>
    <div class="failures-grid">

      <div class="failure-card">
        <div class="failure-icon">‚ö°</div>
        <div class="tag tag-simulated">Intentionally Simulated</div>
        <h3>Checksum Failures</h3>
        <div class="numbers">
          <div class="num-block">
            <div class="num" style="color:#d29922">37</div>
            <div class="num-label">Total failures</div>
          </div>
          <div class="num-block">
            <div class="num" style="color:#d29922">~3%</div>
            <div class="num-label">Failure rate</div>
          </div>
          <div class="num-block">
            <div class="num" style="color:#768390">1,186</div>
            <div class="num-label">Total processed</div>
          </div>
        </div>
        <p>The producer deliberately corrupts ~1 in 50 chunk checksums to prove the pipeline detects them. In production, a real mismatch means the segment was corrupted in transit ‚Äî the encoder would be asked to retransmit. These are counted, logged, and alerted ‚Äî but processing of other chunks continues uninterrupted.</p>
      </div>

      <div class="failure-card">
        <div class="failure-icon">üî¢</div>
        <div class="tag tag-simulated">Intentionally Injected</div>
        <h3>Sequence Gaps in Live Stream</h3>
        <div class="numbers">
          <div class="num-block">
            <div class="num" style="color:#d29922">217</div>
            <div class="num-label">Gaps detected</div>
          </div>
          <div class="num-block">
            <div class="num" style="color:#768390">~1</div>
            <div class="num-label">Per 1,000 chunks</div>
          </div>
        </div>
        <p>The producer deliberately skips a sequence number once per 1,000-chunk stream to simulate a dropped segment. In production, a gap means the encoder missed a segment, which would appear as a brief freeze or artefact for viewers. Spark detects it, increments the counter, and continues processing ‚Äî the manifest is still updated around the missing chunk.</p>
      </div>

      <div class="failure-card">
        <div class="failure-icon">üñ•Ô∏è</div>
        <div class="tag tag-expected">Resource Constraint</div>
        <h3>Live Latency Above Threshold</h3>
        <div class="numbers">
          <div class="num-block">
            <div class="num" style="color:#f85149">~2s</div>
            <div class="num-label">p99 latency</div>
          </div>
          <div class="num-block">
            <div class="num" style="color:#3fb950">0</div>
            <div class="num-label">Kafka lag</div>
          </div>
          <div class="num-block">
            <div class="num" style="color:#3fb950">&lt;500ms</div>
            <div class="num-label">Production SLA</div>
          </div>
        </div>
        <p>14 Docker containers compete for your Mac's CPU and memory. The JVM (Spark + Kafka), two Python processes (producer + API), MongoDB, and MinIO all share the same cores. Despite the high latency, <strong style="color:#cdd9e5">Kafka lag is 0</strong> ‚Äî Spark processes every chunk before the next one arrives. On a server with dedicated cores, latency drops below 200ms.</p>
      </div>

    </div>
  </div>


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- SECTION 5: THROUGHPUT BREAKDOWN -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section">
    <h2>Throughput &amp; Storage</h2>
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">

      <div class="bar-chart">
        <h3 style="margin-bottom:18px">Processing Rates</h3>

        <div class="bar-group">
          <div class="bar-top">
            <span class="bar-name">Live chunks produced/s</span>
            <span class="bar-val" style="color:#58a6ff">1.32 /s</span>
          </div>
          <div class="bar-outer"><div class="bar-inner" style="width:66%;background:#58a6ff"></div></div>
        </div>

        <div class="bar-group">
          <div class="bar-top">
            <span class="bar-name">Live chunks processed by Spark/s</span>
            <span class="bar-val" style="color:#3fb950">1.32 /s</span>
          </div>
          <div class="bar-outer"><div class="bar-inner" style="width:66%;background:#3fb950"></div></div>
        </div>

        <div class="bar-group">
          <div class="bar-top">
            <span class="bar-name">VOD episodes uploaded/s</span>
            <span class="bar-val" style="color:#58a6ff">0.055 /s</span>
          </div>
          <div class="bar-outer"><div class="bar-inner" style="width:5.5%;background:#58a6ff"></div></div>
        </div>

        <div class="bar-group">
          <div class="bar-top">
            <span class="bar-name">VOD variants generated/s</span>
            <span class="bar-val" style="color:#3fb950">0.32 /s</span>
          </div>
          <div class="bar-outer"><div class="bar-inner" style="width:32%;background:#3fb950"></div></div>
        </div>

        <div class="bar-group">
          <div class="bar-top">
            <span class="bar-name">Simulated live bandwidth</span>
            <span class="bar-val" style="color:#bc8cff">~1.65 MB/s</span>
          </div>
          <div class="bar-outer"><div class="bar-inner" style="width:55%;background:#bc8cff"></div></div>
        </div>

        <div class="bar-group">
          <div class="bar-top">
            <span class="bar-name">Simulated VOD bandwidth</span>
            <span class="bar-val" style="color:#bc8cff">~0.69 MB/s</span>
          </div>
          <div class="bar-outer"><div class="bar-inner" style="width:23%;background:#bc8cff"></div></div>
        </div>
      </div>

      <div class="bar-chart">
        <h3 style="margin-bottom:18px">MinIO Object Storage</h3>

        <div class="bar-group">
          <div class="bar-top">
            <span class="bar-name">live-streams (chunks)</span>
            <span class="bar-val" style="color:#f85149">~181+ objects</span>
          </div>
          <div class="bar-outer"><div class="bar-inner" style="width:90%;background:#f85149"></div></div>
        </div>

        <div class="bar-group">
          <div class="bar-top">
            <span class="bar-name">vod-variants (quality renditions)</span>
            <span class="bar-val" style="color:#e3b341">36 objects</span>
          </div>
          <div class="bar-outer"><div class="bar-inner" style="width:18%;background:#e3b341"></div></div>
        </div>

        <div class="bar-group">
          <div class="bar-top">
            <span class="bar-name">manifests (.m3u8 HLS playlists)</span>
            <span class="bar-val" style="color:#3fb950">10 objects</span>
          </div>
          <div class="bar-outer"><div class="bar-inner" style="width:5%;background:#3fb950"></div></div>
        </div>

        <div class="bar-group">
          <div class="bar-top">
            <span class="bar-name">vod-raw (original uploads)</span>
            <span class="bar-val" style="color:#58a6ff">10 objects</span>
          </div>
          <div class="bar-outer"><div class="bar-inner" style="width:5%;background:#58a6ff"></div></div>
        </div>

        <div style="margin-top:20px; padding:12px; background:#21262d; border-radius:6px; font-size:11px; color:#768390; line-height:1.7">
          <strong style="color:#cdd9e5">Note:</strong> All objects are zero-byte placeholders ‚Äî the pipeline simulates video processing without storing actual video bytes. This is intentional: the object <em>paths and structure</em> (including HLS manifest content) are production-accurate; only the payload is empty.
        </div>
      </div>

    </div>
  </div>


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- SECTION 6: SERVICES -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section">
    <h2>Service Inventory ‚Äî All Healthy</h2>
    <div class="services-grid">

      <div class="service-card">
        <div class="svc-icon">üì®</div>
        <div class="svc-name">Apache Kafka</div>
        <div class="svc-status">‚óè UP</div>
        <div class="svc-detail">KRaft mode<br>2 topics ¬∑ 9 partitions</div>
      </div>

      <div class="service-card">
        <div class="svc-icon">‚ö°</div>
        <div class="svc-name">Apache Spark</div>
        <div class="svc-status">‚óè UP</div>
        <div class="svc-detail">2 streaming queries<br>1 master ¬∑ 1 worker</div>
      </div>

      <div class="service-card">
        <div class="svc-icon">üóÑÔ∏è</div>
        <div class="svc-name">MongoDB</div>
        <div class="svc-status">‚óè UP</div>
        <div class="svc-detail">58 VOD docs<br>1,149 live chunks</div>
      </div>

      <div class="service-card">
        <div class="svc-icon">ü™£</div>
        <div class="svc-name">MinIO</div>
        <div class="svc-status">‚óè UP</div>
        <div class="svc-detail">4 buckets<br>~237 objects</div>
      </div>

      <div class="service-card">
        <div class="svc-icon">üîå</div>
        <div class="svc-name">FastAPI</div>
        <div class="svc-status">‚óè UP</div>
        <div class="svc-detail">Healthy<br>pipeline-api</div>
      </div>

      <div class="service-card">
        <div class="svc-icon">üìä</div>
        <div class="svc-name">Prometheus</div>
        <div class="svc-status">‚óè UP</div>
        <div class="svc-detail">7 targets<br>scraping every 15s</div>
      </div>

      <div class="service-card">
        <div class="svc-icon">üìà</div>
        <div class="svc-name">Grafana</div>
        <div class="svc-status">‚óè UP</div>
        <div class="svc-detail">32 panels<br>uid: prometheus ‚úì</div>
      </div>

    </div>
  </div>


  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- FOOTER -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="footer">
    <div>
      <strong style="color:#cdd9e5">Kafka-Spark Video Streaming Pipeline</strong> ¬∑
      <a href="https://github.com/qalqahtani/kafka-spark-streaming-pipeline" style="color:#58a6ff;text-decoration:none">github.com/qalqahtani/kafka-spark-streaming-pipeline</a>
    </div>
    <div>Generated February 26, 2026 ¬∑ Data sourced from Prometheus at localhost:9090</div>
  </div>

</body>
</html>
